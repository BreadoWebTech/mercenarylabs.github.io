<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mercenary Labs - Google's Beginners Quest - CCTV</title>
    <link rel="stylesheet" href="https://mercenarylabs.net/css/tokyo-night-dark.min.css">
    <link rel='stylesheet' id='ghostkit-css' href='https://mercenarylabs.net/css/1-style.min.css' media='all' />
    <link rel='stylesheet' id='ghostkit-block-grid-css' href='https://mercenarylabs.net/css/2-style.min.css' media='all' />
    <link rel='stylesheet' id='cyberpulse-css' href='https://mercenarylabs.net/css/main.css' media='all' />
    <link rel='stylesheet' href='https://mercenarylabs.net/css/style.css' media='all' />
    <link rel='stylesheet' id='ghostkit-fonts-adobe-css' href='https://use.typekit.net/tfy7mmd.css?ver=1.7.3' media='all' />
    <script src='https://mercenarylabs.net/js/jquery.min.js' id='jquery-core-js'></script>
    <script src='https://mercenarylabs.net/js/jquery-migrate.min.js' id='jquery-migrate-js'></script>
    <script src='https://mercenarylabs.net/js/imagesloaded.min.js' id='imagesloaded-js'></script>
    <script id='cyberpulse-preloader-js-extra'> var cplPreloaderData = { "show_once": "" }; </script>
    <script src='https://mercenarylabs.net/js/preloader.js' id='cyberpulse-preloader-js'></script>
    <script
        id='ghost-framework-night-mode-js-extra'> var ghostFrameworkNightMode = { "default": "night", "is_editor": "", "use_local_storage": "", "night_class": "cpl-night-mode", "switching_class": "cpl-night-mode-switching", "toggle_selector": ".cpl-night-mode-toggle" }; </script>
    <script src='https://mercenarylabs.net/js/night-mode.min.js' id='ghost-framework-night-mode-js'></script>
</head>

<body
    class="home page-template-default page page-id-6 wp-embed-responsive content-size-container content-without-top-margin content-without-bottom-margin">

    <div class="cpl-preloader">
        <div class="cpl-preloader-logo">
            <!-- <img src="logo.png" class="cpl-logo-night" data-skip-lazy="" alt="" /> -->
        </div>
    </div>

    <div class="cpl-page-noise"></div>

    <div id="page" class="site">

        <header id="masthead" class="site-header">
            <div class="cpl-navbar-container cpl-navbar-collapse-md cpl-navbar-align-right">
                <a href="/" class="cpl-navbar-logo">
                    <h1>ML</h1>
                </a>
            </div>
        </header>

        <div id="content" class="site-content" tabindex="-1">
            <div id="primary" class="content-area">
                <main id="main" class="site-main">
                    <article id="post-6" class="post-6 page type-page status-publish hentry">
                        <div class="entry-content">
                            <div style="padding-bottom:1px!important;padding-top:1px!important"
                                class="ghostkit-grid ghostkit-grid-gap-md ghostkit-grid-with-bg ghostkit-custom-1709OK">
                                <div class="nk-awb alignfull">
                                    <div class="nk-awb-wrap" data-awb-type="image" data-awb-parallax="scroll"
                                        data-awb-parallax-speed="0.8" data-awb-parallax-mobile="true"
                                        data-awb-image-background-size="cover"
                                        data-awb-image-background-position="50% 10%">
                                        <div class="nk-awb-overlay" style="background-color: rgba(23, 23, 23, 0.8);">
                                        </div>
                                        <div class="nk-awb-inner"> <img class="vp-lazyload"
                                                data-src="https://mercenarylabs.net/images/soldiers.jpg" data-sizes="auto" loading="eager"
                                                height="1em"> </div>
                                    </div>
                                </div>

                                <div class="ghostkit-grid-inner">
                                    <div class="ghostkit-col ghostkit-col-12">
                                        <div class="ghostkit-col-content">
                                            <p class="has-text-align-center has-text-color"
                                                style="color:#f4f4f4;font-size:50px"
                                                data-ghostkit-sr="fade-up;distance:10px;duration:500;delay:100">
                                                <span class="ghostkit-text-uppercase">
                                                    <strong>WRITE-UP</strong>
                                                </span>
                                            </p>

                                            <div class="wp-block-image ghostkit-custom-Z1gmenb">
                                                <a> <img loading="lazy" class="aligncenter vp-lazyload" width="250px"
                                                        data-src="https://mercenarylabs.net/images/patch_bl.png" data-sizes="auto"> </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div style="padding-top:80px!important;padding-bottom:0px!important;"
                                class="ghostkit-grid ghostkit-grid-gap-md ghostkit-grid-with-bg ghostkit-custom-22dvsW">
                                <div class="nk-awb alignfull">
                                    <div class="nk-awb-wrap" data-awb-type="color">
                                        <div class="nk-awb-overlay" style="background-color: #101010;"></div>
                                    </div>
                                </div>

                                <div class="ghostkit-grid-inner">
                                    <div class="ghostkit-col ghostkit-col-12">
                                        <div class="ghostkit-col-content">

                                            <!-- Start of Content-->

                                            <h1 class="has-text-align-center"
                                                data-ghostkit-sr="fade-up;distance:1px;duration:500;delay:200;">
                                                Google's Beginners Quest - CCTV
                                            </h1>
                                            <h3 class="has-text-align-center"
                                                data-ghostkit-sr="fade-up;distance:1px;duration:500;delay:200">
                                                By: Breado
                                            </h4>

                                            <h2>Links</h2>
                                            <h4 style="margin:0px;">CTF Homepage: <a href="https://capturetheflag.withgoogle.com/beginners-quest">https://capturetheflag.withgoogle.com/beginners-quest</a></h4>
                                            <h4 style="margin-top:5px;">CCTV Challenge Page: <a href="https://cctv-web.2021.ctfcompetition.com/">https://cctv-web.2021.ctfcompetition.com/</a></h4>

                                            <h2>Intro</h2>
                                            This ctf challenge was pretty fun. For me, it was pretty hard to figure out,
                                            since ive never participated in this kind of ctf before. But after solving
                                            it, it seems pretty easy, and I'm gonna tell you guys how I did it, my thoughts through the whole
                                            challenge, etc. It took me about 40 minutes to complete. Lets hop right in.

                                            <h2>Part 1</h2>
                                            When I looked at the "home-site", I immediately found the first challenge
                                            marked with a "1" on the right side of the site. Clicking on that, I see
                                            this:

                                            <br><br><img class="aligncenter" src="images/cctv-breado-1.png"><br>

                                            The description of the challenge says this: <br><br>

                                            <i>You have now investigated the chemical plant. Nothing seemed to be out
                                            of the ordinary, even though the workers acted somewhat passive, but
                                            thats not a good enough to track. It seems like you have a new voice
                                            mail from the boss: "hello there, agent! It seems like the corporation
                                            that owns the plant was informed by an anonymous source that you would
                                            arrive, and therefore they were prepared for your visit, but your
                                            colleague agent x has a lead in prague, weve already booked you a
                                            flight. First class of course. In fact if you look out of the window,
                                            you should be able to see a black car arriving now, and it will carry
                                            you to the airport. Good luck!"</i> <br><br>

                                            The story is cool, but it doesnt really help me with the ctf. Under the
                                            text, I can see a little field, with a link:
                                            https://cctv-web.2021.ctfcompetition.com. <br><br>
                                            Which is obviously the ctf
                                            challenge. Clicking on that, I arrive on a page that looks like this:

                                            <br><br><img class="aligncenter" src="images/cctv-breado-2.png"><br>

                                            <h2>Part 2</h2>
                                            As we can see, theres a input box, which prompts us to input the
                                            password in order to gain access to the site. My very first thought
                                            was, that I could try to perform an xss attack (executing
                                            javascript code inside a site trough unsanitized input), so I went
                                            right ahead, putting this into the input box:
                                            <pre><code class="language-js">&lt;script&gt;alert(&quot;. &quot;);&lt;/script&gt;</code></pre>

                                            Sadly, this didnt work out at all. I got a alert box though, but it
                                            says that the password is wrong. Since the XSS didnt work, I took a
                                            look at the source code of the website. When I saw the source code of the site, I immediately headed to the
                                            javascript code:

                                            <br><br><img class="aligncenter" src="images/cctv-breado-3.png"><br>

                                            :ooking at the javascript code, I was able to see that it
                                            creates a fucnction called "checkpassword", which is obviously
                                            exactly what I'm looking for. Looking further into the code, I
                                            can see the following things: <br>
                                            - The function is called when the button with the id "go" is
                                            clicked or if the enter key is pressed while focused on the
                                            password input field with the id "password"<br>
                                            - The function gets the stuff you entered in the password field
                                            and then comverts each char of the string into a number `0xcafe`. <br><br>

                                            With a little bit of research I found out that its converted
                                            into a number and its a hexadecimal value for 51918 ( which will
                                            be important later ) using "charCodeAt"
                                            and checkes it against these values: [52037, 52077, 52077,
                                            52066, 52046, 52063, 52081, 52077, 52085, 52081, 52080, 52066];<br><br>

                                            Looking at the if statement, I can see that it checks if the
                                            resulting array matches the one mentioned above, if it does, it
                                            redirects the challenger to another site, with the filename
                                            being the password string you entered + . Html<br><br>

                                            My first thought was to just make the if statement do the
                                            opposite of ehat it does, by adding a ! Flr "not" to the if
                                            statement, like so:

                                            <br><br><img class="aligncenter" src="images/cctv-breado-4.png"><br>

                                            I thought, since it checks if the password is right, and if
                                            it isnt it outputs a alert box, I could just make it
                                            redirect me if the password isnt right. Well, I didnt think
                                            of it needing the password to redirect me to the right page
                                            ( the right password is the filename of the goal page in the
                                            end ).<br><br>
                                            So this obviously didnt work either
                                            then I thought about using some kind of crawler to find
                                            every page for this url, but I didnt try that out since i
                                            felt like it was nonsense.

                                            <h2>Part 3</h2>

                                            At this time, one guy I know on discord already solved the
                                            challenge and mentioned "reverse engineering"
                                            so, I came up with the idea, to make it just do the opposite
                                            of whats it doing with the string we enter, but for the
                                            array it is comparing your input to.
                                            Means, we'll have to subtract the `0xcafe` from the each
                                            value in the array to get the ascii code for each value,
                                            which we then convert each ascii code into a character,
                                            which well put together into a string.
                                            Following that plan, and after a little bit of some more
                                            research, I came up with this python program:
                                            <pre class="align-items-center"><code class="language-python">import re
sequence = [52037, 52077, 52077, 52066, 52046, 52063, 52081, 52081, 52085, 52077, 52080, 52066]
ascii_codes = [n-0xCafe for n in sequence] 
password = ''.join([chr(code) for code in ascii_codes])
match = re.match(r'^[A-Za-z0-9]+', password)

if match:
    print(match.group())
else:
    print(':(')</code></pre>

                                            Explaination what this code does:
                                            it subtracts `0xcafe` from each number in the sequence
                                            to get the ascii code for each character in the
                                            password. Then it uses the chr() function to convert
                                            each ascii code to its character, and joins the
                                            characters together to ceate a string. Then it uses a
                                            regular expression to match the password within the
                                            string and outputs the matched password.

                                            The output was the following:
                                            <br><br><img class="aligncenter" src="images/cctv-breado-6.png"><br>

                                            Now, I went to the page and entered this password.
                                            It was right.<br><br>

                                            Now we are on a page with a bunch of security
                                            cameras (https://cctv-web.2021.ctfcompetition.com/GoodPassword.html):
                                            <br><br><img class="aligncenter" src="images/cctv-breado-7.png"><br>

                                            Scrolling to the end of the page, I found the
                                            flag:

                                            <br><br><img class="aligncenter" src="images/cctv-breado-8.png"><br>

                                            Headed to
                                            "https://capturetheflag.withgoogle.com/beginners-quest"
                                            and copy and pasted it into the flag-box
                                            and it was the right flag!

                                            <h2>Conclusion</h2>

                                            So I got the challenge done, and learned a
                                            bunch of new things:<br>
                                            - what charCodeAt() is<br>
                                            - recognizing hexadecimal values<br><br>

                                            I really enjoyed both writing this writeup
                                            and solving the challenge : )

                                            <!-- End of Content-->

                                        </div>
                                    </div>
                                </div>
                                <div class="ghostkit-grid-inner">
                                    <div class="ghostkit-col ghostkit-col-12">
                                        <div class="ghostkit-col-content">
                                            <h2 class="has-text-align-center" id="6-ready-to-use-demos"
                                                data-ghostkit-sr="fade-up;distance:10px;duration:500;delay:200">
                                                <br>
                                                <hr style="margin-bottom: 16px;">
                                                SECURITY - INTELLIGENCE - DEVELOPMENT
                                                <hr>
                                            </h2>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                </main>
            </div>
        </div>
    </div>
    <script src="https://mercenarylabs.net/js/wpdf.min.js" defer></script>
    <script id='ghostkit-helper-js-extra'>
        document.documentElement.classList.add('ghostkit-sr-enabled');
        document.documentElement.classList.add('vp-lazyload-enabled');
        var ghostkitVariables = { "themeName": "CyberPulse", "settings": [], "disabledBlocks": [], "media_sizes": { "sm": 567, "md": 777, "lg": 1077, "xl": 1387 }, "timezone": "UTC+00:00", "googleMapsAPIKey": "", "googleMapsAPIUrl": "https:\/\/maps.googleapis.com\/maps\/api\/js?v=3.exp&language=en", "googleMapsLibrary": { "url": "https:\/\/wp.nkdev.info\/cyberpulse\/promo\/wp-content\/plugins\/ghostkit\/assets\/vendor\/gmaps\/gmaps.min.js?ver=0.4.25" }, "googleReCaptchaAPISiteKey": "", "googleReCaptchaAPISecretKey": "", "sidebars": { "sidebar-post": { "id": "sidebar-post", "name": "Posts Sidebar" }, "sidebar-page": { "id": "sidebar-page", "name": "Pages Sidebar" }, "sidebar-woocommerce": { "id": "sidebar-woocommerce", "name": "WooCommerce Sidebar" }, "sidebar-cyberpress": { "id": "sidebar-cyberpress", "name": "CyberPress Sidebar" }, "offcanvas": { "id": "offcanvas", "name": "Offcanvas" }, "mobile-navbar": { "id": "mobile-navbar", "name": "Mobile Navbar" }, "sidebar-above-footer": { "id": "sidebar-above-footer", "name": "Footer Widgets" }, "sidebar-above-footer-1": { "id": "sidebar-above-footer-1", "name": "Footer Widgets Column 1" }, "sidebar-above-footer-2": { "id": "sidebar-above-footer-2", "name": "Footer Widgets Column 2" }, "sidebar-above-footer-3": { "id": "sidebar-above-footer-3", "name": "Footer Widgets Column 3" }, "sidebar-above-footer-4": { "id": "sidebar-above-footer-4", "name": "Footer Widgets Column 4" } }, "icons": [], "shapes": [], "fonts": [], "customTypographyList": [], "variants": { "accordion": { "default": { "title": "Default" } }, "accordion_item": { "default": { "title": "Default" } }, "alert": { "default": { "title": "Default" } }, "button_wrapper": { "default": { "title": "Default" } }, "button": { "default": { "title": "Default" } }, "carousel": { "default": { "title": "Default" } }, "carousel_slide": { "default": { "title": "Default" } }, "changelog": { "default": { "title": "Default" } }, "counter_box": { "default": { "title": "Default" } }, "divider": { "default": { "title": "Default" } }, "gist": { "default": { "title": "Default" } }, "google_maps": { "default": { "title": "Default" } }, "grid": { "default": { "title": "Default" } }, "grid_column": { "default": { "title": "Default" } }, "icon_box": { "default": { "title": "Default" } }, "instagram": { "default": { "title": "Default" } }, "pricing_table": { "default": { "title": "Default" } }, "pricing_table_item": { "default": { "title": "Default" } }, "progress": { "default": { "title": "Default" } }, "tabs": { "default": { "title": "Default" } }, "tabs_tab": { "default": { "title": "Default" } }, "testimonial": { "default": { "title": "Default" } }, "twitter": { "default": { "title": "Default" } }, "video": { "default": { "title": "Default" } } }, "admin_url": "https:\/\/wp.nkdev.info\/cyberpulse\/promo\/wp-admin\/", "admin_templates_url": "https:\/\/wp.nkdev.info\/cyberpulse\/promo\/wp-admin\/edit.php?post_type=ghostkit_template" };
    </script>
    <script src='https://mercenarylabs.net/js/helper.min.js' id='ghostkit-helper-js'></script>
    <script src='https://mercenarylabs.net/js/scrollreveal.min.js' id='scrollreveal-js'></script>
    <script src='https://mercenarylabs.net/js/main.min.js' id='ghostkit-js'></script>
    <script src='https://mercenarylabs.net/js/lazysizes-cfg.min.js' id='lazysizes-config-js'></script>
    <script src='https://mercenarylabs.net/js/lazysizes.min.js' id='lazysizes-js'></script>
    <script src="https://mercenarylabs.net/js/highlight.min.js"></script>
    <script> hljs.highlightAll();</script>
</body>

</html>
